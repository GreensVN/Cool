-- GreensVN Hub V1.25 - All-in-One Script Hub (No Stealth, No Admin Detect, Welcome Popup, Hack Tab Scrollable)
-- By Oxbl149 & GreensVN

-- ==== ADMIN-STYLE WELCOME POPUP (viền trắng nổi bật cho popup + tên) ====
do
    local player = game:GetService("Players").LocalPlayer

    local preGui = Instance.new("ScreenGui")
    preGui.Name = "GreensVNHubWelcome"
    preGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
    preGui.IgnoreGuiInset = true
    preGui.ResetOnSpawn = false
    preGui.Parent = game:GetService("CoreGui")

    local main = Instance.new("Frame")
    main.Name = "Main"
    main.AnchorPoint = Vector2.new(0.5, 0.5)
    main.Position = UDim2.new(0.5, 0, 0.5, -20)
    main.Size = UDim2.new(0, 465, 0, 140)
    main.BackgroundColor3 = Color3.fromRGB(255, 226, 110)
    main.BackgroundTransparency = 0
    main.BorderSizePixel = 0
    main.Parent = preGui
    main.ClipsDescendants = true

    -- White stroke viền ngoài popup
    local stroke = Instance.new("UIStroke", main)
    stroke.Color = Color3.fromRGB(255,255,255)
    stroke.Thickness = 4
    stroke.Transparency = 0

    local shadow = Instance.new("ImageLabel", main)
    shadow.Name = "Shadow"
    shadow.BackgroundTransparency = 1
    shadow.Image = "rbxassetid://1316045217"
    shadow.ImageTransparency = 0.82
    shadow.Size = UDim2.new(1, 32, 1, 32)
    shadow.Position = UDim2.new(0, -16, 0, -16)
    shadow.ZIndex = 0

    local cor = Instance.new("UICorner", main)
    cor.CornerRadius = UDim.new(0.19, 0)

    -- Icon cảnh báo Roblox (dấu chấm than vàng)
    local icon = Instance.new("ImageLabel", main)
    icon.BackgroundTransparency = 1
    icon.Size = UDim2.new(0, 56, 0, 56)
    icon.Position = UDim2.new(0, 25, 0, 17)
    icon.Image = "rbxassetid://7733960981"
    icon.ZIndex = 2

    -- Dòng Welcome (có stroke trắng rõ ràng)
    local label1 = Instance.new("TextLabel", main)
    label1.BackgroundTransparency = 1
    label1.Size = UDim2.new(1, -110, 0, 48)
    label1.Position = UDim2.new(0, 94, 0, 18)
    label1.Font = Enum.Font.GothamBlack
    label1.TextSize = 32
    label1.TextColor3 = Color3.fromRGB(64, 44, 0)
    label1.TextStrokeTransparency = 0.12
    label1.TextStrokeColor3 = Color3.fromRGB(255,255,255)
    label1.Text = "Welcome, " .. tostring(player.DisplayName or player.Name or "User")
    label1.TextWrapped = true
    label1.TextXAlignment = Enum.TextXAlignment.Left
    label1.TextYAlignment = Enum.TextYAlignment.Center

    -- UIStroke trắng bao quanh chữ (rất rõ)
    local label1Stroke = Instance.new("UIStroke", label1)
    label1Stroke.Color = Color3.fromRGB(255,255,255)
    label1Stroke.Thickness = 2
    label1Stroke.Transparency = 0
    label1Stroke.ApplyStrokeMode = Enum.ApplyStrokeMode.Contextual

    -- Dòng cảm ơn
    local label2 = Instance.new("TextLabel", main)
    label2.BackgroundTransparency = 1
    label2.Size = UDim2.new(1, -60, 0, 38)
    label2.Position = UDim2.new(0, 60, 0, 78)
    label2.Font = Enum.Font.Gotham
    label2.TextSize = 22
    label2.TextColor3 = Color3.fromRGB(100, 70, 0)
    label2.TextStrokeTransparency = 0.55
    label2.TextStrokeColor3 = Color3.fromRGB(255,255,255)
    label2.Text = "Cảm ơn vì bạn đã tin tưởng và sử dụng"
    label2.TextWrapped = true
    label2.TextXAlignment = Enum.TextXAlignment.Left
    label2.TextYAlignment = Enum.TextYAlignment.Top

    local label2Stroke = Instance.new("UIStroke", label2)
    label2Stroke.Color = Color3.fromRGB(255,255,255)
    label2Stroke.Thickness = 1.2
    label2Stroke.Transparency = 0.1
    label2Stroke.ApplyStrokeMode = Enum.ApplyStrokeMode.Contextual

    -- Fade in
    main.BackgroundTransparency = 1
    icon.ImageTransparency = 1
    label1.TextTransparency = 1
    label2.TextTransparency = 1
    label1Stroke.Transparency = 1
    label2Stroke.Transparency = 1

    for i = 0, 1, 0.08 do
        main.BackgroundTransparency = 1 - i
        icon.ImageTransparency = 1 - i
        label1.TextTransparency = 1 - i
        label2.TextTransparency = 1 - i
        label1Stroke.Transparency = 1 - i
        label2Stroke.Transparency = 1 - i
        task.wait(0.02)
    end

    wait(2.5)

    -- Fade out
    for i = 0, 1, 0.1 do
        main.BackgroundTransparency = i
        icon.ImageTransparency = i
        label1.TextTransparency = i
        label2.TextTransparency = i
        label1Stroke.Transparency = i
        label2Stroke.Transparency = i
        task.wait(0.016)
    end
    preGui:Destroy()
end

-- ==== GUI CHÍNH VỚI HACK TAB SCROLLABLE ====
local TweenService = game:GetService("TweenService")
local RunService = game:GetService("RunService")
local Players = game:GetService("Players")
local HttpService = game:GetService("HttpService")
local MarketplaceService = game:GetService("MarketplaceService")
local player = Players.LocalPlayer
local ThumbnailType = Enum.ThumbnailType.HeadShot
local ThumbnailSize = Enum.ThumbnailSize.Size420x420

local MIN_SIZE = Vector2.new(350, 250)
local MAX_SIZE = Vector2.new(750, 650)
local TAB_WIDTH = 132
local AVATAR_ID = "rbxassetid://86684458914012"
local DEFAULT_SCALE = 1
local SCALE_STEP = 0.1
local MIN_SCALE = 0.7
local MAX_SCALE = 1.6
local DEFAULT_COLOR = Color3.fromRGB(30, 32, 40)
local currentScale = DEFAULT_SCALE
local currentColor = DEFAULT_COLOR

local function applyGuiScale(mainFrame, scale)
    mainFrame.Size = UDim2.new(0, 540 * scale, 0, 590 * scale)
    mainFrame.Position = UDim2.new(0.5, -270 * scale, 0.5, -295 * scale)
end

local function applyGuiColor(mainFrame, newColor)
    mainFrame.BackgroundColor3 = newColor
end

local screenGui = Instance.new("ScreenGui")
screenGui.Name = "greensvn hub v2.0"
screenGui.Parent = player:WaitForChild("PlayerGui")
screenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
screenGui.ResetOnSpawn = false

-- Add background animation (animated gradient)
local animatedBg = Instance.new("Frame")
animatedBg.Size = UDim2.new(1, 0, 1, 0)
animatedBg.Position = UDim2.new(0, 0, 0, 0)
animatedBg.BackgroundTransparency = 1
animatedBg.ZIndex = -1
animatedBg.Parent = screenGui

local gradient = Instance.new("UIGradient")
gradient.Color = ColorSequence.new{
    ColorSequenceKeypoint.new(0, Color3.fromRGB(50,180,120)),
    ColorSequenceKeypoint.new(0.5, Color3.fromRGB(80,60,160)),
    ColorSequenceKeypoint.new(1, Color3.fromRGB(40,80,220))
}
gradient.Rotation = 0
gradient.Parent = animatedBg

-- Animate gradient rotation forever
spawn(function()
    while true do
        for i = 0, 360, 1 do
            gradient.Rotation = i
            wait(0.03)
        end
    end
end)

-- MainFrame
local mainFrame = Instance.new("Frame")
mainFrame.Size = UDim2.new(0, 540, 0, 590)
mainFrame.Position = UDim2.new(0.5, -270, 0.5, -295)
mainFrame.BackgroundColor3 = DEFAULT_COLOR
mainFrame.BorderSizePixel = 0
mainFrame.Parent = screenGui
mainFrame.ClipsDescendants = true

local TweenService = game:GetService("TweenService")
mainFrame.Size = UDim2.new(0, 0, 0, 0)
mainFrame.BackgroundTransparency = 1
TweenService:Create(mainFrame, TweenInfo.new(0.38, Enum.EasingStyle.Back), {
    Size = UDim2.new(0, 540, 0, 590),
    BackgroundTransparency = 0
}):Play()

local mainStroke = Instance.new("UIStroke", mainFrame)
mainStroke.Color = Color3.fromRGB(90, 180, 90)
mainStroke.Thickness = 2

local mainCorner = Instance.new("UICorner", mainFrame)
mainCorner.CornerRadius = UDim.new(0, 16)

local shadow = Instance.new("ImageLabel")
shadow.Name = "Shadow"
shadow.BackgroundTransparency = 1
shadow.Image = "rbxassetid://1316045217"
shadow.ImageTransparency = 0.7
shadow.Size = UDim2.new(1, 40, 1, 40)
shadow.Position = UDim2.new(0, -20, 0, -20)
shadow.ZIndex = 0
shadow.Parent = mainFrame

-- TopBar
local topBar = Instance.new("Frame")
topBar.Size = UDim2.new(1, 0, 0, 64)
topBar.BackgroundColor3 = Color3.fromRGB(36, 38, 50)
topBar.BorderSizePixel = 0
topBar.Parent = mainFrame
local topBarCorner = Instance.new("UICorner", topBar)
topBarCorner.CornerRadius = UDim.new(0, 16)

local avatar = Instance.new("ImageLabel")
avatar.Name = "Avatar"
avatar.Size = UDim2.new(0, 54, 0, 54)
avatar.Position = UDim2.new(0, 9, 0, 5)
avatar.BackgroundTransparency = 1
avatar.Image = AVATAR_ID
avatar.Parent = topBar
local avatarCorner = Instance.new("UICorner", avatar)
avatarCorner.CornerRadius = UDim.new(1, 0)

local titleLabel = Instance.new("TextLabel")
titleLabel.Size = UDim2.new(1, -180, 1, 0)
titleLabel.Position = UDim2.new(0, 75, 0, 0)
titleLabel.BackgroundTransparency = 1
titleLabel.Text = "greensvn hub v2.0"
titleLabel.TextColor3 = Color3.fromRGB(120, 255, 120)
titleLabel.Font = Enum.Font.GothamBold
titleLabel.TextSize = 30
titleLabel.TextXAlignment = Enum.TextXAlignment.Left
titleLabel.Parent = topBar

local minBtn = Instance.new("TextButton")
minBtn.Size = UDim2.new(0, 34, 0, 34)
minBtn.Position = UDim2.new(1, -84, 0, 15)
minBtn.BackgroundColor3 = Color3.fromRGB(60,80,60)
minBtn.Text = "-"
minBtn.Font = Enum.Font.GothamBold
minBtn.TextSize = 26
minBtn.TextColor3 = Color3.fromRGB(255,255,255)
minBtn.Parent = topBar
local minCorner = Instance.new("UICorner", minBtn)
minCorner.CornerRadius = UDim.new(0.5, 0)

local closeBtn = Instance.new("TextButton")
closeBtn.Size = UDim2.new(0, 34, 0, 34)
closeBtn.Position = UDim2.new(1, -40, 0, 15)
closeBtn.BackgroundColor3 = Color3.fromRGB(120,60,60)
closeBtn.Text = "x"
closeBtn.TextColor3 = Color3.fromRGB(255,255,255)
closeBtn.Font = Enum.Font.GothamBold
closeBtn.TextSize = 18
closeBtn.Parent = topBar
local closeCorner = Instance.new("UICorner", closeBtn)
closeCorner.CornerRadius = UDim.new(0.5, 0)
closeBtn.AutoButtonColor = true
closeBtn.MouseButton1Click:Connect(function()
    screenGui:Destroy()
end)

local TweenService = game:GetService("TweenService")

local function animateBtn(btn, color1, color2)
    btn.MouseEnter:Connect(function()
        TweenService:Create(btn, TweenInfo.new(0.11), {BackgroundColor3 = color2}):Play()
    end)
    btn.MouseLeave:Connect(function()
        TweenService:Create(btn, TweenInfo.new(0.13), {BackgroundColor3 = color1}):Play()
    end)
    btn.MouseButton1Down:Connect(function()
        TweenService:Create(btn, TweenInfo.new(0.11), {BackgroundColor3 = color2:lerp(Color3.new(1,0.6,0.6), 0.2)}):Play()
    end)
    btn.MouseButton1Up:Connect(function()
        TweenService:Create(btn, TweenInfo.new(0.11), {BackgroundColor3 = color2}):Play()
    end)
end
animateBtn(closeBtn, Color3.fromRGB(120,60,60), Color3.fromRGB(180,60,60))
animateBtn(minBtn, Color3.fromRGB(60,80,60), Color3.fromRGB(90,120,80))

-- Tab holder
local tabNames = {"Home", "Hack", "Executor", "Library", "Settings", "Credit"}
local tabHolder = Instance.new("Frame")
tabHolder.Size = UDim2.new(0, TAB_WIDTH, 1, -64)
tabHolder.Position = UDim2.new(0, 0, 0, 64)
tabHolder.BackgroundColor3 = Color3.fromRGB(36, 38, 50)
tabHolder.BorderSizePixel = 0
tabHolder.Parent = mainFrame
local tabHolderCorner = Instance.new("UICorner", tabHolder)
tabHolderCorner.CornerRadius = UDim.new(0, 16)

local tabBtns = {}
for i, name in ipairs(tabNames) do
    local btn = Instance.new("TextButton")
    btn.Size = UDim2.new(1, -16, 0, 46)
    btn.Position = UDim2.new(0, 8, 0, (i-1)*56 + 12)
    btn.BackgroundColor3 = (i==1) and Color3.fromRGB(64, 110, 64) or Color3.fromRGB(55, 55, 65)
    btn.Text = name
    btn.TextColor3 = Color3.new(1,1,1)
    btn.Font = Enum.Font.GothamBold
    btn.TextSize = 22
    btn.Parent = tabHolder
    local btnCorner = Instance.new("UICorner", btn)
    btnCorner.CornerRadius = UDim.new(0.4, 0)
    tabBtns[i] = btn
end

local TweenService = game:GetService("TweenService")
local sidebarCollapsed = false
local COLLAPSED_WIDTH = 38
local EXPANDED_WIDTH = TAB_WIDTH

local collapseBtn = Instance.new("TextButton")
collapseBtn.Size = UDim2.new(0, 32, 0, 32)
collapseBtn.Position = UDim2.new(1, -38, 0, 12)
collapseBtn.BackgroundColor3 = Color3.fromRGB(30, 60, 30)
collapseBtn.Text = "≡"
collapseBtn.Font = Enum.Font.GothamBold
collapseBtn.TextSize = 18
collapseBtn.TextColor3 = Color3.fromRGB(255,255,255)
collapseBtn.Parent = tabHolder
local collapseCorner = Instance.new("UICorner", collapseBtn)
collapseCorner.CornerRadius = UDim.new(0.5, 0)

local function animateSidebar(collapse)
    local newWidth = collapse and COLLAPSED_WIDTH or EXPANDED_WIDTH
    TweenService:Create(tabHolder, TweenInfo.new(0.32, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), {Size = UDim2.new(0, newWidth, 1, -64)}):Play()
    for i, btn in ipairs(tabBtns) do
        TweenService:Create(btn, TweenInfo.new(0.18), {
            TextTransparency = collapse and 1 or 0,
            BackgroundTransparency = collapse and 0.5 or 0
        }):Play()
        btn.Text = collapse and "" or tabNames[i]
    end
end

collapseBtn.MouseButton1Click:Connect(function()
    sidebarCollapsed = not sidebarCollapsed
    animateSidebar(sidebarCollapsed)
    collapseBtn.Text = sidebarCollapsed and "▶" or "≡"
end)

local tabFrames = {}
local tabFrameSpace = UDim2.new(1, -TAB_WIDTH, 1, -64)
local tabFramePos = UDim2.new(0, TAB_WIDTH, 0, 64)

-- 1. Home Tab (thêm viền trắng cho Welcome)
local homeFrame = Instance.new("Frame")
homeFrame.Size = tabFrameSpace
homeFrame.Position = tabFramePos
homeFrame.BackgroundColor3 = Color3.fromRGB(35, 38, 48)
homeFrame.BorderSizePixel = 0
homeFrame.Parent = mainFrame
homeFrame.Visible = true
tabFrames[1] = homeFrame
local homeCorner = Instance.new("UICorner", homeFrame)
homeCorner.CornerRadius = UDim.new(0, 16)
local homePadding = Instance.new("UIPadding", homeFrame)
homePadding.PaddingTop = UDim.new(0, 10)
homePadding.PaddingLeft = UDim.new(0, 40)

-- Welcome line (có UIStroke viền trắng)
local welcomeLabel = Instance.new("TextLabel")
welcomeLabel.Size = UDim2.new(1, -40, 0, 36)
welcomeLabel.Position = UDim2.new(0, 0, 0, 0)
welcomeLabel.BackgroundTransparency = 1
welcomeLabel.Font = Enum.Font.GothamBlack
welcomeLabel.TextSize = 30
welcomeLabel.TextColor3 = Color3.fromRGB(120, 255, 120)
welcomeLabel.TextXAlignment = Enum.TextXAlignment.Left
welcomeLabel.Text = "Welcome, " .. tostring(player.DisplayName or player.Name or "User")
welcomeLabel.Parent = homeFrame
local welcomeStroke = Instance.new("UIStroke", welcomeLabel)
welcomeStroke.Color = Color3.fromRGB(255,255,255)
welcomeStroke.Thickness = 1.5
welcomeStroke.Transparency = 0

-- Roblox Avatar (UserThumbnail)
local bigAvatar = Instance.new("ImageLabel")
bigAvatar.Size = UDim2.new(0,130,0,130)
bigAvatar.Position = UDim2.new(0, 0, 0, 40)
bigAvatar.BackgroundTransparency = 1
bigAvatar.Image = "rbxasset://textures/ui/GuiImagePlaceholder.png"
bigAvatar.Parent = homeFrame
local bigAvatarCorner = Instance.new("UICorner", bigAvatar)
bigAvatarCorner.CornerRadius = UDim.new(1, 0)
spawn(function()
    local thumbContent, isReady = Players:GetUserThumbnailAsync(player.UserId, ThumbnailType, ThumbnailSize)
    if isReady then
        bigAvatar.Image = thumbContent
    end
end)

-- Username/Name/UserId
local nameLabel = Instance.new("TextLabel")
nameLabel.Size = UDim2.new(0, 330, 0, 32)
nameLabel.Position = UDim2.new(0, 145, 0, 54)
nameLabel.BackgroundTransparency = 1
nameLabel.Font = Enum.Font.GothamBold
nameLabel.TextSize = 25
nameLabel.TextColor3 = Color3.fromRGB(120, 255, 120)
nameLabel.TextXAlignment = Enum.TextXAlignment.Left
nameLabel.Text = "Name: Loading..."
nameLabel.Parent = homeFrame

local userLabel = Instance.new("TextLabel")
userLabel.Size = UDim2.new(0, 330, 0, 26)
userLabel.Position = UDim2.new(0, 145, 0, 86)
userLabel.BackgroundTransparency = 1
userLabel.Font = Enum.Font.Gotham
userLabel.TextSize = 21
userLabel.TextColor3 = Color3.fromRGB(200, 255, 200)
userLabel.TextXAlignment = Enum.TextXAlignment.Left
userLabel.Text = "Username: Loading..."
userLabel.Parent = homeFrame

local userIdLabel = Instance.new("TextLabel")
userIdLabel.Size = UDim2.new(0, 330, 0, 24)
userIdLabel.Position = UDim2.new(0, 145, 0, 116)
userIdLabel.BackgroundTransparency = 1
userIdLabel.Font = Enum.Font.Gotham
userIdLabel.TextSize = 20
userIdLabel.TextColor3 = Color3.fromRGB(200, 255, 255)
userIdLabel.TextXAlignment = Enum.TextXAlignment.Left
userIdLabel.Text = "UserId: Loading..."
userIdLabel.Parent = homeFrame

-- Place Name + PlaceId
local placeLabel = Instance.new("TextLabel")
placeLabel.Size = UDim2.new(1, -40, 0, 32)
placeLabel.Position = UDim2.new(0, 0, 0, 172)
placeLabel.BackgroundTransparency = 1
placeLabel.TextColor3 = Color3.fromRGB(255,255,220)
placeLabel.Font = Enum.Font.GothamBold
placeLabel.TextSize = 20
placeLabel.TextXAlignment = Enum.TextXAlignment.Left
placeLabel.Text = "Place: Loading..."
placeLabel.Parent = homeFrame

-- IP Address and Account Age
local ipLabel = Instance.new("TextLabel")
ipLabel.Size = UDim2.new(1, -40, 0, 26)
ipLabel.Position = UDim2.new(0, 0, 0, 208)
ipLabel.BackgroundTransparency = 1
ipLabel.TextColor3 = Color3.fromRGB(255,255,180)
ipLabel.Font = Enum.Font.Gotham
ipLabel.TextSize = 19
ipLabel.TextXAlignment = Enum.TextXAlignment.Left
ipLabel.Text = "IP Address: Loading..."
ipLabel.Parent = homeFrame

local ageLabel = Instance.new("TextLabel")
ageLabel.Size = UDim2.new(1, -40, 0, 26)
ageLabel.Position = UDim2.new(0, 0, 0, 234)
ageLabel.BackgroundTransparency = 1
ageLabel.TextColor3 = Color3.fromRGB(255,255,180)
ageLabel.Font = Enum.Font.Gotham
ageLabel.TextSize = 19
ageLabel.TextXAlignment = Enum.TextXAlignment.Left
ageLabel.Text = "Account Age: Loading..."
ageLabel.Parent = homeFrame

-- Location (Province, Country, Capital, Continent)
local geoLabel = Instance.new("TextLabel")
geoLabel.Size = UDim2.new(1, -40, 0, 70)
geoLabel.Position = UDim2.new(0, 0, 0, 260)
geoLabel.BackgroundTransparency = 1
geoLabel.TextColor3 = Color3.fromRGB(255,255,180)
geoLabel.Font = Enum.Font.Gotham
geoLabel.TextSize = 19
geoLabel.TextXAlignment = Enum.TextXAlignment.Left
geoLabel.TextYAlignment = Enum.TextYAlignment.Top
geoLabel.Text = "Vị trí của bạn: Đang tải..."
geoLabel.Parent = homeFrame

-- Update user info
local displayName = player.DisplayName or "Unknown"
local username = player.Name or "Unknown"
local userId = player.UserId or "Unknown"
local accountAge = player.AccountAge or "Unknown"
nameLabel.Text = "Name: "..displayName
userLabel.Text = "Username: "..username
userIdLabel.Text = "UserId: "..userId
ageLabel.Text = "Account Age: "..tostring(accountAge).." days"

-- Place info (Name + PlaceId)
placeLabel.Text = "Place: Đang tải..."
spawn(function()
    local placeId = game.PlaceId
    local placeName = "Unknown"
    local ok, info = pcall(function()
        return MarketplaceService:GetProductInfo(placeId, Enum.InfoType.Asset)
    end)
    if ok and info and info.Name then
        placeName = info.Name
    end
    placeLabel.Text = ("Place: %s [ID: %s]"):format(placeName, tostring(placeId))
end)

-- Get location (province/country/capital/continent) + IP using public API
spawn(function()
    local locationText = "Vị trí của bạn: Không xác định"
    local ipAddr = "Không xác định"
    local success, result = pcall(function()
        local url = "https://ipinfo.io/json"
        return HttpService:JSONDecode(game:HttpGet(url))
    end)
    if success and result then
        local city = result.city or ""
        local region = result.region or ""
        local country = result.country or ""
        local ip = result.ip or ""
        if ip ~= "" then
            ipAddr = ip
        end

        local locStr = ""
        if region ~= "" and country ~= "" then
            locStr = string.format("%s, %s", region, country)
        elseif city ~= "" and country ~= "" then
            locStr = string.format("%s, %s", city, country)
        elseif country ~= "" then
            locStr = string.format("%s", country)
        end

        local capital = ""
        local continent = ""
        if country ~= "" then
            local ok2, res2 = pcall(function()
                local url2 = "https://restcountries.com/v3.1/alpha/"..country
                return HttpService:JSONDecode(game:HttpGet(url2))
            end)
            if ok2 and typeof(res2)=="table" and #res2 >= 1 then
                local c = res2[1]
                if c.capital and typeof(c.capital)=="table" and #c.capital>0 then
                    capital = tostring(c.capital[1])
                end
                if c.continents and typeof(c.continents)=="table" and #c.continents>0 then
                    continent = tostring(c.continents[1])
                end
            end
        end

        locationText = "Vị trí của bạn: "..locStr
        if capital ~= "" then
            locationText = locationText.."\nThủ đô: "..capital
        end
        if continent ~= "" then
            locationText = locationText.."\nChâu lục: "..continent
        end
    end
    ipLabel.Text = "IP Address: "..ipAddr
    geoLabel.Text = locationText
end)

-- 2. Hack Tab (SCROLLABLE)
local tab2Frame = Instance.new("Frame")
tab2Frame.Size = tabFrameSpace
tab2Frame.Position = tabFramePos
tab2Frame.BackgroundColor3 = Color3.fromRGB(38, 40, 52)
tab2Frame.BorderSizePixel = 0
tab2Frame.Parent = mainFrame
tab2Frame.Visible = false
tabFrames[2] = tab2Frame
local hackCorner = Instance.new("UICorner", tab2Frame)
hackCorner.CornerRadius = UDim.new(0, 16)

-- ScrollingFrame cho hack tab
local scroll = Instance.new("ScrollingFrame")
scroll.Size = UDim2.new(1, -12, 1, -12)
scroll.Position = UDim2.new(0, 6, 0, 6)
scroll.BackgroundTransparency = 1
scroll.BorderSizePixel = 0
scroll.ScrollBarThickness = 10
scroll.ScrollingDirection = Enum.ScrollingDirection.Y
scroll.CanvasSize = UDim2.new(0, 0, 0, 420)
scroll.Parent = tab2Frame

local listLayout = Instance.new("UIListLayout", scroll)
listLayout.SortOrder = Enum.SortOrder.LayoutOrder
listLayout.Padding = UDim.new(0, 10)

local btns = {}
local btnNames = {
    "k00pgui v12", "Anti Kick", "Anti Ban",
    "TuananhIOS", "1*1*1*1 gui", "Dead Rail",
    "Buff UI", "Infinite Yield", "Grow a Garden No Lag",
    "Tiger Hub", "Sky Hub", "Tool Giver Remake",
}
for i=1,12 do
    local btn = Instance.new("TextButton")
    btn.Size = UDim2.new(0.93, 0, 0, 44)
    btn.BackgroundColor3 = Color3.fromRGB(70, 90, 80)
    btn.Text = btnNames[i]
    btn.TextColor3 = Color3.new(1,1,1)
    btn.Font = Enum.Font.Gotham
    btn.TextSize = 20
    btn.Name = btnNames[i]
    btn.Parent = scroll
    local bcor = Instance.new("UICorner", btn)
    bcor.CornerRadius = UDim.new(0.3, 0)
    btns[i] = btn
end
listLayout:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(function()
    scroll.CanvasSize = UDim2.new(0, 0, 0, listLayout.AbsoluteContentSize.Y + 18)
end)

-- Notification label for hack tab
local notificationLabel = Instance.new("TextLabel")
notificationLabel.Size = UDim2.new(1, -36, 0, 30)
notificationLabel.Position = UDim2.new(0, 18, 0, 8)
notificationLabel.BackgroundTransparency = 0.4
notificationLabel.BackgroundColor3 = Color3.fromRGB(45, 130, 45)
notificationLabel.Text = ""
notificationLabel.TextColor3 = Color3.fromRGB(255,255,255)
notificationLabel.Font = Enum.Font.GothamBold
notificationLabel.TextSize = 20
notificationLabel.TextXAlignment = Enum.TextXAlignment.Center
notificationLabel.TextYAlignment = Enum.TextYAlignment.Center
notificationLabel.Visible = false
notificationLabel.Parent = scroll
local notifCorner = Instance.new("UICorner", notificationLabel)
notifCorner.CornerRadius = UDim.new(0.5, 0)

local function showHackNotification(txt)
    notificationLabel.Text = txt
    notificationLabel.Visible = true
    spawn(function()
        wait(2.5)
        notificationLabel.Visible = false
    end)
end

btns[1].MouseButton1Click:Connect(function()
    local s = loadstring(game:HttpGet('https://raw.githubusercontent.com/GreensVN/Cool/refs/heads/main/k00pguiv12'))
    if s then s() end
end)
btns[2].MouseButton1Click:Connect(function()
    pcall(function()
        for _,v in ipairs(getconnections(player.Kick)) do
            v:Disable()
        end
    end)
    pcall(function()
        hookfunction(player.Kick, function() return end)
    end)
    pcall(function()
        local mt = getrawmetatable(game)
        setreadonly(mt, false)
        local oldNamecall = mt.__namecall
        mt.__namecall = newcclosure(function(self, ...)
            local method = getnamecallmethod and getnamecallmethod() or ""
            if (method == "Kick" or method:lower() == "kick") and (self == player or tostring(self)=="Players") then
                return
            end
            return oldNamecall(self, ...)
        end)
        setreadonly(mt, true)
    end)
    pcall(function()
        local mt = getrawmetatable(player)
        setreadonly(mt, false)
        local oldIndex = mt.__index
        mt.__index = newcclosure(function(self, key)
            if key == "Kick" then
                return function() return end
            end
            return oldIndex(self, key)
        end)
        setreadonly(mt, true)
    end)
    pcall(function()
        for _,desc in ipairs(game:GetDescendants()) do
            if desc:IsA("RemoteEvent") or desc:IsA("RemoteFunction") then
                if desc.Name:lower():find("kick") then
                    desc:Destroy()
                end
            end
        end
    end)
    showHackNotification("Anti Kick is active now")
end)
btns[3].MouseButton1Click:Connect(function()
    pcall(function()
        for _,v in ipairs(getgc(true)) do
            if typeof(v) == "table" then
                for k,f in pairs(v) do
                    if type(k) == "string" and k:lower():find("ban") then
                        if type(f) == "function" then
                            hookfunction(f, function(...) return nil end)
                        elseif typeof(f) == "Instance" and (f:IsA("RemoteEvent") or f:IsA("RemoteFunction")) then
                            f:Destroy()
                        end
                    end
                end
            end
        end
    end)
    pcall(function()
        local mt = getrawmetatable(game)
        setreadonly(mt, false)
        local oldNamecall = mt.__namecall
        mt.__namecall = newcclosure(function(self, ...)
            local method = getnamecallmethod and getnamecallmethod() or ""
            if method:lower():find("ban") or tostring(self):lower():find("ban") then
                return
            end
            return oldNamecall(self, ...)
        end)
        setreadonly(mt, true)
    end)
    pcall(function()
        for _,desc in ipairs(game:GetDescendants()) do
            if desc:IsA("RemoteEvent") or desc:IsA("RemoteFunction") then
                if desc.Name:lower():find("ban") then
                    for _,conn in ipairs(getconnections(desc.OnClientEvent)) do
                        conn:Disable()
                    end
                    for _,conn in ipairs(getconnections(desc.OnClientInvoke)) do
                        conn:Disable()
                    end
                end
            end
        end
    end)
    showHackNotification("Anti Ban is active now")
end)
btns[4].MouseButton1Click:Connect(function()
    loadstring(game:HttpGet("https://raw.githubusercontent.com/AnhDzaiScript/TuanAnhIOSNew/refs/heads/main/TuanAnhIOS-TongHop.Lua"))()
end)
btns[5].MouseButton1Click:Connect(function()
    loadstring(game:HttpGet("https://raw.githubusercontent.com/GreensVN/Cool/refs/heads/main/tutogui"))()
end)
btns[6].MouseButton1Click:Connect(function()
    loadstring(game:HttpGet("https://raw.githubusercontent.com/InfernusScripts/Null-Fire/main/Loader"))()
end)
btns[7].MouseButton1Click:Connect(function()
    loadstring(game:HttpGet("https://raw.githubusercontent.com/GreensVN/Cool/refs/heads/main/GreensvnBuffUI"))()
end)
btns[8].MouseButton1Click:Connect(function()
    loadstring(game:HttpGet("https://raw.githubusercontent.com/EdgeIY/infiniteyield/master/source"))()
end)
btns[9].MouseButton1Click:Connect(function()   
    loadstring(game:HttpGetAsync("https://raw.githubusercontent.com/NoLag-id/No-Lag-HUB/refs/heads/main/Loader/LoaderV1.lua"))()
end)
btns[10].MouseButton1Click:Connect(function()   
    loadstring(game:HttpGetAsync("https://raw.githubusercontent.com/balintTheDevX/Tiger-X-V3/main/Tiger%20X%20V3.5%20Fixed"))()
end)
btns[11].MouseButton1Click:Connect(function()   
    loadstring(game:HttpGetAsync("https://raw.githubusercontent.com/yofriendfromschool1/Sky-Hub/main/FE%20Trolling%20GUI.luau"))()
end)
btns[12].MouseButton1Click:Connect(function()
    loadstring(game:HttpGet("https://raw.githubusercontent.com/GreensVN/Cool/refs/heads/main/ToolGiver"))()
end)

-- Executor tab
local executorFrame = Instance.new("Frame")
executorFrame.Size = tabFrameSpace
executorFrame.Position = tabFramePos
executorFrame.BackgroundColor3 = Color3.fromRGB(42, 44, 53)
executorFrame.BorderSizePixel = 0
executorFrame.Parent = mainFrame
executorFrame.Visible = false
tabFrames[3] = executorFrame

local executorCorner = Instance.new("UICorner", executorFrame)
executorCorner.CornerRadius = UDim.new(0, 16)

local executorTitle = Instance.new("TextLabel", executorFrame)
executorTitle.Text = "Executor Scripts"
executorTitle.Size = UDim2.new(1, 0, 0, 44)
executorTitle.Position = UDim2.new(0, 0, 0, 20)
executorTitle.BackgroundTransparency = 1
executorTitle.Font = Enum.Font.GothamBold
executorTitle.TextSize = 27
executorTitle.TextColor3 = Color3.fromRGB(120, 200, 255)
executorTitle.TextXAlignment = Enum.TextXAlignment.Center

-- ScrollingFrame cho executor
local execScroll = Instance.new("ScrollingFrame")
execScroll.Size = UDim2.new(1, -24, 1, -82)
execScroll.Position = UDim2.new(0, 12, 0, 64)
execScroll.BackgroundTransparency = 1
execScroll.BorderSizePixel = 0
execScroll.ScrollBarThickness = 10
execScroll.ScrollingDirection = Enum.ScrollingDirection.Y
execScroll.CanvasSize = UDim2.new(0, 0, 0, 400)
execScroll.Parent = executorFrame

local execLayout = Instance.new("UIListLayout", execScroll)
execLayout.SortOrder = Enum.SortOrder.LayoutOrder
execLayout.Padding = UDim.new(0, 10)

-- Danh sách script executor
local executorScripts = {
    {name="AppleWare", url="https://raw.githubusercontent.com/GreensVN/Cool/refs/heads/main/AppleWare"},
    {name="Arceus X V3", url="https://raw.githubusercontent.com/GreensVN/Cool/refs/heads/main/ArceusXV3"},
    {name="Delta X", url="https://raw.githubusercontent.com/GreensVN/Cool/refs/heads/main/DeltaX"},
    {name="KRNL", url="https://raw.githubusercontent.com/GreensVN/Cool/refs/heads/main/krnl"},
    {name="Codex", url="https://raw.githubusercontent.com/GreensVN/Cool/refs/heads/main/Codex"},
    {name="Hydrogen", url="https://raw.githubusercontent.com/GreensVN/Cool/refs/heads/main/Hydrogen"},
    {name="Tidal", url="https://raw.githubusercontent.com/GreensVN/Cool/refs/heads/main/Tidal"},
    {name="Ligma", url="https://raw.githubusercontent.com/GreensVN/Cool/refs/heads/main/Ligma"},
    {name="Project Legma", url="https://raw.githubusercontent.com/GreensVN/Cool/refs/heads/main/ProjectLegma"},
    {name="Synapse X Remake", url="https://raw.githubusercontent.com/GreensVN/Cool/refs/heads/main/SynapseXRemake"},
    {name="RC7", url="https://raw.githubusercontent.com/GreensVN/Cool/refs/heads/main/Rc7"},
    {name="Stigma", url="https://raw.githubusercontent.com/GreensVN/Cool/refs/heads/main/Stigma"},
}
local execBtns = {}
for i, data in ipairs(executorScripts) do
    local btn = Instance.new("TextButton")
    btn.Size = UDim2.new(0.95, 0, 0, 44)
    btn.Position = UDim2.new(0, 0, 0, (i-1)*54)
    btn.BackgroundColor3 = Color3.fromRGB(70, 110, 120)
    btn.Text = data.name
    btn.TextColor3 = Color3.new(1,1,1)
    btn.Font = Enum.Font.GothamBold
    btn.TextSize = 20
    btn.Parent = execScroll
    local bcor = Instance.new("UICorner", btn)
    bcor.CornerRadius = UDim.new(0.3, 0)
    btn.MouseButton1Click:Connect(function()
        local suc, err = pcall(function()
            local scr = loadstring(game:HttpGet(data.url))
            if scr then scr() end
        end)
        if not suc then
            btn.Text = "Script lỗi/Không hỗ trợ!"
            wait(1.2)
            btn.Text = data.name
        end
    end)
    execBtns[i] = btn
end
execLayout:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(function()
    execScroll.CanvasSize = UDim2.new(0, 0, 0, execLayout.AbsoluteContentSize.Y + 18)
end)

-- 3. Library Tab
local scriptLibrary = {
    -- Grow A Garden
    {name="Grow A Garden | NoLag",desc="Buy Candy Blossom, Old Server Finder",url="https://raw.githubusercontent.com/NoLag-id/No-Lag-HUB/refs/heads/main/Loader/LoaderV1.lua",category="Grow A Garden",icon="rbxassetid://12285139195"},
    {name="Grow A Garden | Sucalet",desc="Auto Buy, Auto Farm, ESP",url="https://raw.githubusercontent.com/nootmaus/GrowAAGarden/refs/heads/main/mauscripts",category="Grow A Garden",icon="rbxassetid://12285139195"},
    {name="Grow A Garden | Vxeze Hub",desc="Auto Buy, Auto Farm",url="https://raw.githubusercontent.com/Dex-Bear/Vxezehub/refs/heads/main/VxezeHubMain",category="Grow A Garden",icon="rbxassetid://12285139195"},
    {name="Grow A Garden | H4x Script",desc="Auto Buy, Auto Farm",url="https://raw.githubusercontent.com/H4xScripts/Loader/refs/heads/main/loader2.lua",category="Grow A Garden",icon="rbxassetid://12285139195"},
    {name="Grow A Garden | Native Hub",desc="Auto Buy, Auto Farm",url="https://getnative.cc/script/loader",category="Grow A Garden",icon="rbxassetid://12285139195"},
    {name="Grow A Garden | Grow a Garden Dupe Money",desc="Dupe Money",url="https://raw.githubusercontent.com/Bern0va/Scripts/refs/heads/main/gag-dupe.lua",category="Grow A Garden",icon="rbxassetid://12285139195"},
    {name="Grow A Garden | Lunor Hub",desc="Auto Collect Fruits, Auto Farm, ESP",url="https://lunor.dev/loader",category="Grow A Garden",icon="rbxassetid://12285139195"},
    {name="Grow A Garden | Dupe Script",desc="Dupe",url="https://pastefy.app/P5CQPKQ2/raw",category="Grow A Garden",icon="rbxassetid://12285139195"},
    {name="Grow A Garden | Garden (One Click Script)",desc="One Click Script =))",url="https://api.realaya.xyz/v1/files/l/yqx3a5r6t4oj1o0lbx14nutwl4sc97bq.lua",category="Grow A Garden",icon="rbxassetid://12285139195"},
    {name="Grow A Garden | Lion Hub",desc="Auto Buy, Auto Farm",url="https://api.luarmor.net/files/v3/loaders/e0c7fcf6c077fc23475cf4ce4db58e42.lua",category="Grow A Garden",icon="rbxassetid://12285139195"},
    {name="Grow A Garden | Airflow Hub",desc="Auto Buy, Auto Farm",url="https://api.luarmor.net/files/v3/loaders/255ac567ced3dcb9e69aa7e44c423f19.lua",category="Grow A Garden",icon="rbxassetid://12285139195"},
    {name="Grow A Garden | Alchemy Hub",desc="Auto Buy, Auto Farm, Dupe money",url="https://scripts.alchemyhub.xyz",category="Grow A Garden",icon="rbxassetid://12285139195"},
    {name="Grow A Garden | Neox Hub",desc="Auto Buy, Auto Farm",url="https://raw.githubusercontent.com/lilsketty/sketty-loader/refs/heads/main/GETSKETTY",category="Grow A Garden",icon="rbxassetid://12285139195"},
    -- Dead Rails
    {name="Dead Rails | SpineWare",desc="Auto Farm, Auto Sell, Auto Bounty, Auto Burn, ESP",url="https://raw.githubusercontent.com/SpineWare/UniversalLoader/refs/heads/main/Load",category="Dead Rails",icon="rbxassetid://12285139195"},
    {name="Dead Rails | Alippo Hub",desc="Farm Auto Bonds, Bypass, Teleport",url="https://pastebin.com/raw/8rwA08Ch",category="Dead Rails",icon="rbxassetid://12285139195"},
    {name="Dead Rails | Rift",desc="Auto Farm, Auto Collect, ESP, Plugins",url="https://rifton.top/loader.lua",category="Dead Rails",icon="rbxassetid://12285139195"},
    {name="Dead Rails | OP Script",desc="Auto Collect, Auto Heal, Aimbot, ESP",url="https://nicuse.xyz/MainHub.lua",category="Dead Rails",icon="rbxassetid://12285139195"},
    {name="Dead Rails | Native Hub",desc="Bonds Farm, Auto Bonds",url="https://getnative.cc/script/loader",category="Dead Rails",icon="rbxassetid://12285139195"},
    {name="Dead Rails | Kiciahook V2",desc="Auto Collect, Auto Farm, ESP",url="https://raw.githubusercontent.com/kiciahook/kiciahook/refs/heads/main/loader.luau",category="Dead Rails",icon="rbxassetid://12285139195"},
    {name="Dead Rails | Dead Rails ESP Script",desc="Master ESP =))",url="https://raw.githubusercontent.com/TrustsenseDev/MicroHub/refs/heads/main/loader.lua",category="Dead Rails",icon="rbxassetid://12285139195"},
    {name="Dead Rails | Null Fire",desc="Master ESP =))",url="https://raw.githubusercontent.com/InfernusScripts/Null-Fire/main/Loader",category="Dead Rails",icon="rbxassetid://12285139195"},
    -- Blox Fruits
    {name="Blox Fruits | Thunder Z Hub",desc="Autofarm, Raid, Fruit, ESP, v.v.",url="https://raw.githubusercontent.com/ThundarZ/Welcome/main/Main/Loader/AllGame.lua",category="Blox Fruits",icon="rbxassetid://12285139195"},
    {name="Blox Fruits | Hoho Hub",desc="Autofarm, Kill Aura, Auto Raid, Fruit Snipe.",url="https://raw.githubusercontent.com/acsu123/HohoV2/main/ScriptLoad.lua",category="Blox Fruits",icon="rbxassetid://12285139195"},
    {name="Blox Fruits | Mukuro Hub",desc="Farm, Raid, Stats, Fruit, ESP.",url="https://raw.githubusercontent.com/xQuartyx/QuartyzScript/main/Loader.lua",category="Blox Fruits",icon="rbxassetid://12285139195"},
    {name="Blox Fruits | Banana Hub",desc="Auto Farm, Fruit, Raid, ESP, v.v.",url="https://raw.githubusercontent.com/kimprobloxdz/Banana-Free/refs/heads/main/Protected_5609200582002947.lua.txt",category="Blox Fruits",icon="rbxassetid://12285139195"},
    {name="Blox Fruits | Maru Hub",desc="Auto Farm, Fruit, Raid, ESP, v.v.",url="https://raw.githubusercontent.com/xshiba/MaruHub/main/Loader.lua",category="Blox Fruits",icon="rbxassetid://12285139195"},
    {name="Blox Fruits | Redz Hub",desc="Auto Farm, Fruit, Raid, ESP, v.v.",url="https://raw.githubusercontent.com/tlredz/Scripts/refs/heads/main/main.luau",category="Blox Fruits",icon="rbxassetid://12285139195"},
    -- King Legacy
    {name="King Legacy | OMG Hub",desc="Farm, Boss, Stats, Skill, ESP.",url="https://raw.githubusercontent.com/Omgshit/Scripts/main/MainLoader.lua",category="King Legacy",icon="rbxassetid://12285139334"},
    {name="King Legacy | HYPER",desc="Auto Farm, Boss, Stats, ESP.",url="https://raw.githubusercontent.com/DookDekDEE/Hyper/main/script.lua",category="King Legacy",icon="rbxassetid://12285139334"},
    -- Pet Simulator X
    {name="Pet Simulator X | Project WD",desc="Auto Farm, Open Egg, Auto Quest.",url="https://raw.githubusercontent.com/wally-rblx/ps99/main/main.lua",category="Pet Simulator X",icon="rbxassetid://12285139428"},
    {name="Pet Simulator X | Milk Up",desc="Auto Farm, Pet, Dupe, v.v.",url="https://raw.githubusercontent.com/RunDTM/PetSimulatorX/main/MilkUp.lua",category="Pet Simulator X",icon="rbxassetid://12285139428"},
    -- Anime Adventures
    {name="Anime Adventures | BLCK",desc="Farm, Replay, Gems, Auto Place.",url="https://raw.githubusercontent.com/BLCKAD/AnimeAdventure/main/BLCKAD.lua",category="Anime Adventures",icon="rbxassetid://12285139563"},
    {name="Anime Adventures | Fruit Hub",desc="Auto Farm, Gems, Tower, v.v.",url="https://raw.githubusercontent.com/fruitblade/AnimeAdventures/main/FruitHub.lua",category="Anime Adventures",icon="rbxassetid://12285139563"},
    -- Doors
    {name="Doors | Vynixius",desc="Auto win, ESP, No jumpscare.",url="https://raw.githubusercontent.com/RegularVynixu/Vynixius/main/Doors/Script.lua",category="Doors",icon="rbxassetid://12285139601"},
    {name="Doors | Entity Spawner V2",desc="Spawn entity, troll, ESP.",url="https://raw.githubusercontent.com/RegularVynixu/Utilities/main/Doors/Entity%20Spawner/V2/Source.lua",category="Doors",icon="rbxassetid://12285139601"},
    -- Brookhaven
    {name="Brookhaven | Sander XY",desc="ESP, Troll, Fly, Car Mods.",url="https://raw.githubusercontent.com/kigredns/testUIDK/refs/heads/main/panel.lua",category="Brookhaven 🏡RP",icon="rbxassetid://12285139711"},
    -- Build A Boat
    {name="Build A Boat | BoatBuilderHub",desc="Auto Farm, Build.",url="https://raw.githubusercontent.com/catblox1346/StensUIReMake/refs/heads/main/Script/boatbuilderhub_B1",category="Build A Boat",icon="rbxassetid://12285139812"},
    {name="Build A Boat | Build A Boat For Treasure",desc="Auto Farm, Build.",url="https://raw.githubusercontent.com/NittarPP/PhotonScript/refs/heads/main/Loading/Loading.lua",category="Build A Boat",icon="rbxassetid://12285139812"},
    {name="Build A Boat | WeshkyAutoBuild",desc="Auto Farm, Build.",url="https://raw.githubusercontent.com/suntisalts/BetaTesting/refs/heads/main/WeshkyAutoBuild.lua",category="Build A Boat",icon="rbxassetid://12285139812"},
    {name="Build A Boat | Rolly Hub",desc="Auto Farm, Build.",url="https://raw.githubusercontent.com/XRoLLu/Rolly_Hub/main/open-source-trash-loader.exe.yeah",category="Build A Boat",icon="rbxassetid://12285139812"},
    {name="Build A Boat | Ather Hub",desc="Auto Farm, Build.",url="https://api.luarmor.net/files/v3/loaders/2529a5f9dfddd5523ca4e22f21cceffa.lua",category="Build A Boat",icon="rbxassetid://12285139812"},
    -- Arsenal
    {name="Arsenal | OwlHub",desc="Silent Aim, ESP, Fly, v.v.",url="https://raw.githubusercontent.com/CriShoux/OwlHub/master/OwlHub.txt",category="Arsenal",icon="rbxassetid://12285139941"},
    -- Murder Mystery 2
    {name="Murder Mystery 2 | Vynixius",desc="ESP, Auto Win, Unlock All.",url="https://raw.githubusercontent.com/RegularVynixu/Utilities/main/Murder%20Mystery%202/Loader.lua",category="Murder Mystery 2",icon="rbxassetid://12285140055"},
    -- Shindo Life
    {name="Shindo Life | Shindo Hub",desc="Auto Farm, Spin, Boss, v.v.",url="https://raw.githubusercontent.com/8ZShindo/ShindoHub/main/Script",category="Shindo Life",icon="rbxassetid://12285140112"},
    -- Adopt Me!
    {name="Adopt Me! | AdoptMe Hub",desc="Auto Farm, Dupe, ESP, Egg.",url="https://raw.githubusercontent.com/1f0yt/community/main/AdoptMe",category="Adopt Me!",icon="rbxassetid://12285140455"},
    -- Survive the Killer!
    {name="Survive the Killer! | STK Hub",desc="Auto Coin, ESP, Troll.",url="https://raw.githubusercontent.com/1f0yt/community/main/SurvivetheKiller",category="Survive the Killer!",icon="rbxassetid://12285140580"},
    -- Project Slayers
    {name="Project Slayers | PSX Hub",desc="Auto Farm, Boss, Stat, Tele.",url="https://raw.githubusercontent.com/PSXHUB/ProjectSlayers/main/PSXHUB.lua",category="Project Slayers",icon="rbxassetid://12285140641"},
    -- BedWars
    {name="BedWars | Vape V4",desc="Kill Aura, ESP, Fly, v.v.",url="https://raw.githubusercontent.com/7GranddadPGN/VapeV4ForRoblox/main/NewMainScript.lua",category="BedWars",icon="rbxassetid://12285140846"},
    -- Evade
    {name="Evade | Evade Hub",desc="Auto Farm, ESP, Teleport.",url="https://raw.githubusercontent.com/1f0yt/community/main/Evade",category="Evade",icon="rbxassetid://12285140912"},
    -- Elemental Battlegrounds
    {name="Elemental Battlegrounds | EB Hub",desc="Auto Kill, ESP, Unlock.",url="https://raw.githubusercontent.com/1f0yt/community/main/ElementalBattlegrounds",category="Elemental Battlegrounds",icon="rbxassetid://12285140998"},
    -- Anime Fighters
    {name="Anime Fighters | AFS Hub",desc="Farm, Teleport, Boss.",url="https://raw.githubusercontent.com/1f0yt/community/main/AnimeFighters",category="Anime Fighters",icon="rbxassetid://12285141066"},
    -- Bee Swarm Simulator
    {name="Bee Swarm | BSS Hub",desc="Auto Farm, Quest, Honey.",url="https://raw.githubusercontent.com/1f0yt/community/main/BeeSwarmSimulator",category="Bee Swarm Simulator",icon="rbxassetid://12285141130"},
    -- Da Hood
    {name="Da Hood | Space Hub",desc="Silent Aim, God, Fly, Cash Aura.",url="https://raw.githubusercontent.com/Lucasfin000/SpaceHub/main/SpaceHubLoader",category="Da Hood",icon="rbxassetid://12285141227"},
    -- Tower of Hell
    {name="Tower of Hell | TOH Hub",desc="Auto Win, Anti Cheat, ESP.",url="https://raw.githubusercontent.com/1f0yt/community/main/TowerofHell",category="Tower of Hell",icon="rbxassetid://12285141308"},
    -- Jailbreak
    {name="Jailbreak | JB Hub",desc="Auto Rob, ESP, Teleport.",url="https://raw.githubusercontent.com/1f0yt/community/main/Jailbreak",category="Jailbreak",icon="rbxassetid://12285141399"},
    -- Natural Disaster
    {name="Natural Disaster | NDS Hub",desc="Auto Survive, ESP, Godmode.",url="https://raw.githubusercontent.com/1f0yt/community/main/NaturalDisasterSurvival",category="Natural Disaster",icon="rbxassetid://12285141484"},
    -- Funky Friday
    {name="Funky Friday | FF Hub",desc="Auto Play, Unlock All, Troll.",url="https://raw.githubusercontent.com/1f0yt/community/main/FunkyFriday",category="Funky Friday",icon="rbxassetid://12285141566"},
    -- Dragon Blox
    {name="Dragon Blox | DBZ Hub",desc="Auto Farm, Boss, Stat Hack.",url="https://raw.githubusercontent.com/1f0yt/community/main/DragonBlox",category="Dragon Blox",icon="rbxassetid://12285141654"},
    -- My Restaurant
    {name="My Restaurant | MR Hub",desc="Auto Earn, Speed, Unlock.",url="https://raw.githubusercontent.com/1f0yt/community/main/MyRestaurant",category="My Restaurant",icon="rbxassetid://12285141742"},
    -- Slap Battles
    {name="Slap Battles | SB Hub",desc="Auto Slap, Anti Ban, ESP.",url="https://raw.githubusercontent.com/1f0yt/community/main/SlapBattles",category="Slap Battles",icon="rbxassetid://12285141839"},
    -- The Mimic
    {name="The Mimic | Mimic Hub",desc="ESP, Auto Win, Ghost Mode.",url="https://raw.githubusercontent.com/1f0yt/community/main/TheMimic",category="The Mimic",icon="rbxassetid://12285141928"},
    -- Car Dealership Tycoon
    {name="Car Dealership | CDT Hub",desc="Auto Money, Unlock All Car.",url="https://raw.githubusercontent.com/1f0yt/community/main/CarDealershipTycoon",category="Car Dealership Tycoon",icon="rbxassetid://12285142016"},
    -- Clicker Simulator
    {name="Clicker Simulator | CS Hub",desc="Auto Click, Rebirth, Unlock Pet.",url="https://raw.githubusercontent.com/1f0yt/community/main/ClickerSimulator",category="Clicker Simulator",icon="rbxassetid://12285142105"},
    -- All Star Tower Defense
    {name="All Star Tower Defense | ASTD Hub",desc="Auto Farm, Infinite Gems.",url="https://raw.githubusercontent.com/1f0yt/community/main/AllStarTowerDefense",category="All Star Tower Defense",icon="rbxassetid://12285142196"},
    -- Pls Donate
    {name="Pls Donate | PD Hub",desc="Auto Claim Booth, ESP, Auto Send.",url="https://raw.githubusercontent.com/1f0yt/community/main/PlsDonate",category="Pls Donate",icon="rbxassetid://12285142287"},
    -- Mining Simulator 2
    {name="Mining Simulator 2 | MS2 Hub",desc="Auto Mine, Sell, Unlock Pet.",url="https://raw.githubusercontent.com/1f0yt/community/main/MiningSimulator2",category="Mining Simulator 2",icon="rbxassetid://12285142378"},
    -- Tower Defense Simulator
    {name="Tower Defense Simulator | TDS Hub",desc="Auto Place, Farm, Unlock Tower.",url="https://raw.githubusercontent.com/1f0yt/community/main/TowerDefenseSimulator",category="Tower Defense Simulator",icon="rbxassetid://12285142469"},
    -- Anime Dimensions
    {name="Anime Dimensions | AD Hub",desc="Auto Farm, Unlock Code, ESP.",url="https://raw.githubusercontent.com/1f0yt/community/main/AnimeDimensions",category="Anime Dimensions",icon="rbxassetid://12285142560"},
    -- Ninja Legends
    {name="Ninja Legends | NL Hub",desc="Auto Swing, Sell, Buy.",url="https://raw.githubusercontent.com/1f0yt/community/main/NinjaLegends",category="Ninja Legends",icon="rbxassetid://12285142649"},
    -- BIG Paintball
    {name="BIG Paintball | BP Hub",desc="Silent Aim, ESP, Auto Win.",url="https://raw.githubusercontent.com/1f0yt/community/main/BigPaintball",category="BIG Paintball",icon="rbxassetid://12285142736"},
    -- Mad City
    {name="Mad City | MC Hub",desc="Auto Rob, ESP, Teleport.",url="https://raw.githubusercontent.com/1f0yt/community/main/MadCity",category="Mad City",icon="rbxassetid://12285142825"},
    -- Speed Run 4
    {name="Speed Run 4 | SR Hub",desc="Auto Complete, Anti Cheat, Troll.",url="https://raw.githubusercontent.com/1f0yt/community/main/SpeedRun4",category="Speed Run 4",icon="rbxassetid://12285142914"},
    -- Theme Park Tycoon 2
    {name="Theme Park Tycoon 2 | TPT2 Hub",desc="Auto Build, Unlock, Money Hack.",url="https://raw.githubusercontent.com/1f0yt/community/main/ThemeParkTycoon2",category="Theme Park Tycoon 2",icon="rbxassetid://12285143003"},
    -- Ninja Tycoon
    {name="Ninja Tycoon | NT Hub",desc="Auto Farm, Unlock, ESP.",url="https://raw.githubusercontent.com/1f0yt/community/main/NinjaTycoon",category="Ninja Tycoon",icon="rbxassetid://12285143094"},
    -- Bee Swarm Simulator 2
    {name="Bee Swarm 2 | BSS2 Hub",desc="Auto Collect, Quest, Honey.",url="https://raw.githubusercontent.com/1f0yt/community/main/BeeSwarmSimulator2",category="Bee Swarm Simulator",icon="rbxassetid://12285143183"},
    -- Weight Lifting Simulator
    {name="Weight Lifting | WLS Hub",desc="Auto Lift, Rebirth, Unlock.",url="https://raw.githubusercontent.com/1f0yt/community/main/WeightLiftingSimulator",category="Weight Lifting Simulator",icon="rbxassetid://12285143276"},
    -- Bubble Gum Simulator
    {name="Bubble Gum Sim | BGS Hub",desc="Auto Blow, Sell, Unlock Pet.",url="https://raw.githubusercontent.com/1f0yt/community/main/BubbleGumSimulator",category="Bubble Gum Simulator",icon="rbxassetid://12285143366"},
    -- Rogue Lineage
    {name="Rogue Lineage | RL Hub",desc="ESP, Anti Ban, Troll.",url="https://raw.githubusercontent.com/1f0yt/community/main/RogueLineage",category="Rogue Lineage",icon="rbxassetid://12285143457"},
    -- Islands
    {name="Islands | Islands Hub",desc="Auto Farm, Build, Unlock.",url="https://raw.githubusercontent.com/1f0yt/community/main/Islands",category="Islands",icon="rbxassetid://12285143548"},
    -- Lumber Tycoon 2
    {name="Lumber Tycoon 2 | LT2 Hub",desc="Auto Dupe, Sell, Unlock Saw.",url="https://raw.githubusercontent.com/1f0yt/community/main/LumberTycoon2",category="Lumber Tycoon 2",icon="rbxassetid://12285143641"},
    -- Counter Blox
    {name="Counter Blox | CB Hub",desc="Silent Aim, ESP, Anti Ban.",url="https://raw.githubusercontent.com/1f0yt/community/main/CounterBlox",category="Counter Blox",icon="rbxassetid://12285143734"},
    -- Tower Blitz
    {name="Tower Blitz | TB Hub",desc="Auto Farm, Unlock Tower, Anti Cheat.",url="https://raw.githubusercontent.com/1f0yt/community/main/TowerBlitz",category="Tower Blitz",icon="rbxassetid://12285143913"},
    -- Super Power Training Sim
    {name="Super Power Training | SPTS Hub",desc="Auto Train, Quest, Unlock.",url="https://raw.githubusercontent.com/1f0yt/community/main/SuperPowerTrainingSimulator",category="Super Power Training Sim",icon="rbxassetid://12285144004"},
    -- Breaking Point
    {name="Breaking Point | BP Hub",desc="ESP, Auto Win, Troll.",url="https://raw.githubusercontent.com/1f0yt/community/main/BreakingPoint",category="Breaking Point",icon="rbxassetid://12285144097"},
    -- Ragdoll Engine
    {name="Ragdoll Engine | RE Hub",desc="Troll, Fly, Push, Mods.",url="https://raw.githubusercontent.com/1f0yt/community/main/RagdollEngine",category="Ragdoll Engine",icon="rbxassetid://12285144190"},
    -- Prison Life
    {name="Prison Life | PL Hub",desc="Auto Farm, ESP, Teleport.",url="https://raw.githubusercontent.com/1f0yt/community/main/PrisonLife",category="Prison Life",icon="rbxassetid://12285144284"},
    -- Treasure Quest
    {name="Treasure Quest | TQ Hub",desc="Auto Farm, Unlock Item, ESP.",url="https://raw.githubusercontent.com/1f0yt/community/main/TreasureQuest",category="Treasure Quest",icon="rbxassetid://12285144376"},
    -- Ràng buộc các game nổi tiếng khác
    {name="Ninja Legends 2 | NL2 Hub",desc="Auto Farm, Unlock Pet, Auto Buy.",url="https://raw.githubusercontent.com/1f0yt/community/main/NinjaLegends2",category="Ninja Legends 2",icon="rbxassetid://12285144611"},
    {name="Sword Fighters Sim | SFS Hub",desc="Auto Swing, Rebirth, Unlock Weapon.",url="https://raw.githubusercontent.com/1f0yt/community/main/SwordFightersSimulator",category="Sword Fighters Simulator",icon="rbxassetid://12285144722"},
    {name="Murderers VS Sheriffs",desc="ESP, Troll, Win.",url="https://raw.githubusercontent.com/1f0yt/community/main/MurderersVsSheriffs",category="Murderers VS Sheriffs",icon="rbxassetid://12285144834"},
    {name="Bee Swarm Simulator (M)",desc="Auto Farm, Quest, Honey.",url="https://raw.githubusercontent.com/Muhammad6196/scripts/main/BeeSwarmSimulator.lua",category="Bee Swarm Simulator",icon="rbxassetid://12285143183"},
    {name="Anime Warriors",desc="Auto Farm, Auto Rebirth, Unlock All.",url="https://raw.githubusercontent.com/1f0yt/community/main/AnimeWarriors",category="Anime Warriors",icon="rbxassetid://12285144945"},
    {name="Anime Battle Arena",desc="Auto Farm, ESP, Unlock All.",url="https://raw.githubusercontent.com/1f0yt/community/main/AnimeBattleArena",category="Anime Battle Arena",icon="rbxassetid://12285145057"},
    {name="Blox Fruits | Zen Hub",desc="Autofarm, Raid, ESP, v.v.",url="https://raw.githubusercontent.com/ZenHubProject/ZenHub/main/ZenHub.lua",category="Blox Fruits",icon="rbxassetid://12285139195"},
    {name="Blox Fruits | Black Trap Hub",desc="Full hack, farm, boss, fruit.",url="https://raw.githubusercontent.com/BLACKTRAPBLACKTRAP/BlackTrap/main/README.md",category="Blox Fruits",icon="rbxassetid://12285139195"},
    {name="King Legacy | Kl Hub",desc="Farm, Boss, ESP, v.v.",url="https://raw.githubusercontent.com/KingLegacyHub/KLHub/main/KLHub.lua",category="King Legacy",icon="rbxassetid://12285139334"},
    {name="Pet Simulator X | Project WD (alt)",desc="Auto Farm, Pet, Egg.",url="https://raw.githubusercontent.com/wally-rblx/ps99/main/main.lua",category="Pet Simulator X",icon="rbxassetid://12285139428"},
    {name="Anime Fighters | Astral Hub",desc="Auto Farm, Boss, Teleport.",url="https://raw.githubusercontent.com/AstralAHub/AstralMain/main/AnimeFighters.lua",category="Anime Fighters",icon="rbxassetid://12285141066"},
    {name="Shindo Life | Yuto Hub",desc="Auto Farm, Spin, Boss.",url="https://raw.githubusercontent.com/YutoHub/ShindoLife/main/YutoHub.lua",category="Shindo Life",icon="rbxassetid://12285140112"},
    {name="Build A Boat | Z Hub",desc="Auto Farm, Build, Unlock.",url="https://raw.githubusercontent.com/ZHubDev/BuildABoat/main/ZHub.lua",category="Build A Boat",icon="rbxassetid://12285139812"},
    {name="MM2 | Ice Hub",desc="ESP, Win, Unlock All.",url="https://raw.githubusercontent.com/IceHub/MM2/main/IceHub.lua",category="Murder Mystery 2",icon="rbxassetid://12285140055"},
    {name="Murder Mystery 2 | Prismo Hub",desc="ESP, Knife, Win.",url="https://raw.githubusercontent.com/PrismoHub/MM2/main/PrismoHub.lua",category="Murder Mystery 2",icon="rbxassetid://12285140055"},
    {name="Arsenal | Project Evolution",desc="Silent Aim, ESP, No Recoil.",url="https://raw.githubusercontent.com/ProjectEvolutionHub/Arsenal/main/ProjectEvolution.lua",category="Arsenal",icon="rbxassetid://12285139941"},
    {name="Da Hood | Arctic Hub",desc="Silent Aim, God, Fly, ESP.",url="https://raw.githubusercontent.com/ArcticHub/DaHood/main/ArcticHub.lua",category="Da Hood",icon="rbxassetid://12285141227"},
    {name="Evade | Nice Hub",desc="Auto Farm, ESP, Troll.",url="https://raw.githubusercontent.com/NiceHub/Evade/main/NiceHub.lua",category="Evade",icon="rbxassetid://12285140912"},
    {name="Anime Dimensions | Project AD",desc="Auto Farm, Boss, Unlock Code.",url="https://raw.githubusercontent.com/ProjectADHub/AnimeDimensions/main/ProjectAD.lua",category="Anime Dimensions",icon="rbxassetid://12285142560"},
    {name="Project Slayers | Project Slayers Hub",desc="Farm, Boss, ESP.",url="https://raw.githubusercontent.com/ProjectSlayersHub/ProjectSlayers/main/PSHub.lua",category="Project Slayers",icon="rbxassetid://12285140641"},
    {name="All Star Tower Defense | ASTD X",desc="Farm, Gems, Unlock Tower.",url="https://raw.githubusercontent.com/ASTDXHub/AllStarTD/main/ASTDX.lua",category="All Star Tower Defense",icon="rbxassetid://12285142196"},
    {name="BedWars | Specter Hub",desc="Kill Aura, ESP, Troll.",url="https://raw.githubusercontent.com/SpecterHub/BedWars/main/SpecterHub.lua",category="BedWars",icon="rbxassetid://12285140846"},
    {name="Bee Swarm | Bee Hub",desc="Farm, Honey, Quest, Unlock.",url="https://raw.githubusercontent.com/BeeHub/BeeSwarm/main/BeeHub.lua",category="Bee Swarm Simulator",icon="rbxassetid://12285143183"},
    {name="Natural Disaster | ND Hub",desc="Auto Survive, ESP.",url="https://raw.githubusercontent.com/NDHub/NaturalDisaster/main/NDHub.lua",category="Natural Disaster",icon="rbxassetid://12285141484"},
    {name="Jailbreak | JB X Hub",desc="Auto Rob, ESP, Teleport.",url="https://raw.githubusercontent.com/JBXHub/Jailbreak/main/JBXHub.lua",category="Jailbreak",icon="rbxassetid://12285141399"},
    {name="Anime Fighting Simulator | AFS Hub",desc="Auto Farm, Boss, Teleport.",url="https://raw.githubusercontent.com/AFSHub/AnimeFighting/main/AFSHub.lua",category="Anime Fighting Simulator",icon="rbxassetid://12285145057"},
    {name="Dragon Ball Rage | DBR Hub",desc="Farm, Boss, Unlock, Auto Stats.",url="https://raw.githubusercontent.com/DBRHub/DragonBallRage/main/DBRHub.lua",category="Dragon Ball Rage",icon="rbxassetid://12285141654"},
    -- ... Đủ 75+ scripts từ các hub nổi tiếng và game hot nhất Roblox
}

-- Helper: Badge "HOT" cho script nổi bật
local hotList = {
    ["Blox Fruits"] = true, ["King Legacy"] = true, ["Pet Simulator X"] = true, ["Anime Adventures"] = true, ["Doors"] = true,
    ["BedWars"] = true, ["Da Hood"] = true, ["Jailbreak"] = true, ["Brookhaven 🏡RP"] = true, ["Project Slayers"] = true,
    ["Grow A Garden"] = true, ["Dead Rails"] = true
}

local libraryFrame = Instance.new("Frame")
libraryFrame.Size = tabFrameSpace
libraryFrame.Position = tabFramePos
libraryFrame.BackgroundColor3 = Color3.fromRGB(30, 32, 40)
libraryFrame.BorderSizePixel = 0
libraryFrame.Parent = mainFrame
libraryFrame.Visible = false
tabFrames[4] = libraryFrame
local libraryCorner = Instance.new("UICorner", libraryFrame)
libraryCorner.CornerRadius = UDim.new(0, 18)

-- Shadow cho Library panel
local libShadow = Instance.new("ImageLabel")
libShadow.Name = "LibShadow"
libShadow.BackgroundTransparency = 1
libShadow.Image = "rbxassetid://1316045217"
libShadow.ImageTransparency = 0.82
libShadow.Size = UDim2.new(1, 54, 1, 54)
libShadow.Position = UDim2.new(0, -27, 0, -27)
libShadow.ZIndex = 0
libShadow.Parent = libraryFrame

-- Thanh tìm kiếm & lọc
local searchBox = Instance.new("TextBox")
searchBox.PlaceholderText = "🔍 Tìm kiếm script/game..."
searchBox.Size = UDim2.new(1, -220, 0, 40)
searchBox.Position = UDim2.new(0, 24, 0, 18)
searchBox.BackgroundColor3 = Color3.fromRGB(42, 44, 56)
searchBox.TextColor3 = Color3.new(1,1,1)
searchBox.Font = Enum.Font.Gotham
searchBox.TextSize = 19
searchBox.TextXAlignment = Enum.TextXAlignment.Left
searchBox.ClearTextOnFocus = false
searchBox.Parent = libraryFrame
local searchCorner = Instance.new("UICorner", searchBox)
searchCorner.CornerRadius = UDim.new(0.5, 0)

local TweenService = game:GetService("TweenService")
searchBox.Focused:Connect(function()
    TweenService:Create(searchBox, TweenInfo.new(0.13), {BackgroundColor3 = Color3.fromRGB(60, 80, 120)}):Play()
end)
searchBox.FocusLost:Connect(function()
    TweenService:Create(searchBox, TweenInfo.new(0.18), {BackgroundColor3 = Color3.fromRGB(42, 44, 56)}):Play()
end)

-- Dropdown lọc category với icon
local categories = {"Tất cả"}
local hasCat = {}
for _,v in ipairs(scriptLibrary) do
    if v.category and not hasCat[v.category] then
        table.insert(categories, v.category)
        hasCat[v.category] = true
    end
end
local dropCat = Instance.new("TextButton")
dropCat.Text = "🗂  Tất cả ▼"
dropCat.Size = UDim2.new(0, 170, 0, 40)
dropCat.Position = UDim2.new(1, -190, 0, 18)
dropCat.BackgroundColor3 = Color3.fromRGB(42,44,56)
dropCat.TextColor3 = Color3.fromRGB(255,255,180)
dropCat.Font = Enum.Font.GothamBold
dropCat.TextSize = 19
dropCat.Parent = libraryFrame
local dropCorner = Instance.new("UICorner", dropCat)
dropCorner.CornerRadius = UDim.new(0.5, 0)
local dropList = Instance.new("Frame")
dropList.Visible = false
dropList.Size = UDim2.new(0, 170, 0, 40*(#categories))
dropList.Position = UDim2.new(1, -190, 0, 60)
dropList.BackgroundColor3 = Color3.fromRGB(42,44,56)
dropList.Parent = libraryFrame
dropList.ZIndex = 20
local dCorner = Instance.new("UICorner", dropList)
dCorner.CornerRadius = UDim.new(0.5, 0)
for i,cat in ipairs(categories) do
    local btn = Instance.new("TextButton")
    btn.Text = (cat == "Tất cả" and "🗂  " or "🎮  ") .. cat
    btn.Size = UDim2.new(1, 0, 0, 40)
    btn.Position = UDim2.new(0, 0, 0, (i-1)*40)
    btn.BackgroundColor3 = Color3.fromRGB(42,44,56)
    btn.TextColor3 = Color3.fromRGB(255,255,180)
    btn.Font = Enum.Font.Gotham
    btn.TextSize = 18
    btn.ZIndex = 21
    btn.Parent = dropList
    local bcor = Instance.new("UICorner", btn)
    bcor.CornerRadius = UDim.new(0.5, 0)
    btn.MouseButton1Click:Connect(function()
        dropCat.Text = (cat == "Tất cả" and "🗂  " or "🎮  ")..cat.." ▼"
        dropList.Visible = false
        updateLibraryList()
    end)
    btn.MouseEnter:Connect(function() btn.BackgroundColor3 = Color3.fromRGB(55,60,90) end)
    btn.MouseLeave:Connect(function() btn.BackgroundColor3 = Color3.fromRGB(42,44,56) end)
end
dropCat.MouseButton1Click:Connect(function()
    dropList.Visible = not dropList.Visible
end)

-- ScrollFrame scripts: custom scrollbar, padding, 2 cột nếu rộng
local libScroll = Instance.new("ScrollingFrame")
libScroll.Size = UDim2.new(1, -40, 1, -100)
libScroll.Position = UDim2.new(0, 20, 0, 72)
libScroll.BackgroundTransparency = 1
libScroll.BorderSizePixel = 0
libScroll.ScrollBarThickness = 12
libScroll.ScrollingDirection = Enum.ScrollingDirection.Y
libScroll.CanvasSize = UDim2.new(0, 0, 0, 800)
libScroll.Parent = libraryFrame
libScroll.AutomaticCanvasSize = Enum.AutomaticSize.Y
libScroll.ScrollBarImageColor3 = Color3.fromRGB(120,170,120)
libScroll.ScrollBarImageTransparency = 0.1
local libLayout = Instance.new("UIGridLayout", libScroll)
libLayout.CellPadding = UDim2.new(0,18,0,18)
libLayout.CellSize = UDim2.new(0.48, -12, 0, 116)
libLayout.SortOrder = Enum.SortOrder.LayoutOrder
libScroll.ChildAdded:Connect(function()
    libScroll.CanvasSize = UDim2.new(0,0,0,libLayout.AbsoluteContentSize.Y+18)
end)

-- Responsive: 2 cột nếu đủ rộng, 1 cột trên mobile
libScroll:GetPropertyChangedSignal("AbsoluteSize"):Connect(function()
    local w = libScroll.AbsoluteSize.X
    if w < 440 then
        libLayout.CellSize = UDim2.new(1,-8,0,116)
    else
        libLayout.CellSize = UDim2.new(0.48, -12, 0, 116)
    end
end)

-- Hiển thị tổng số scripts
local scriptCountLabel = Instance.new("TextLabel")
scriptCountLabel.Size = UDim2.new(0, 340, 0, 24)
scriptCountLabel.Position = UDim2.new(0, 24, 1, -36)
scriptCountLabel.BackgroundTransparency = 1
scriptCountLabel.TextColor3 = Color3.fromRGB(120,255,120)
scriptCountLabel.Font = Enum.Font.GothamBold
scriptCountLabel.TextSize = 18
scriptCountLabel.TextXAlignment = Enum.TextXAlignment.Left
scriptCountLabel.Text = ""
scriptCountLabel.Parent = libraryFrame

-- Card style: shadow, nổi, hiệu ứng hover, badge HOT, icon lớn, nút động, popup preview
local function createScriptCard(data)
    local card = Instance.new("Frame")
    card.Size = UDim2.new(1,0,0,116)
    card.BackgroundColor3 = Color3.fromRGB(38, 45, 60)
    card.BorderSizePixel = 0
    card.ZIndex = 2
    local cardCorner = Instance.new("UICorner", card)
    cardCorner.CornerRadius = UDim.new(0.33, 0)
    -- shadow
    local shadow = Instance.new("ImageLabel", card)
    shadow.Image = "rbxassetid://1316045217"
    shadow.Size = UDim2.new(1,16,1,16)
    shadow.Position = UDim2.new(0,-8,0,-8)
    shadow.BackgroundTransparency = 1
    shadow.ImageTransparency = 0.85
    shadow.ZIndex = 1

    -- Icon game lớn
    if data.icon then
        local icon = Instance.new("ImageLabel", card)
        icon.Image = data.icon
        icon.Size = UDim2.new(0, 70, 0, 70)
        icon.Position = UDim2.new(0, 14, 0, 19)
        icon.BackgroundTransparency = 1
        icon.ZIndex = 2
        local icCor = Instance.new("UICorner", icon)
        icCor.CornerRadius = UDim.new(0.5,0)
    end

    -- HOT badge
    if hotList[data.category or ""] then
        local badge = Instance.new("TextLabel", card)
        badge.Text = "🔥 HOT"
        badge.Size = UDim2.new(0, 54, 0, 24)
        badge.Position = UDim2.new(0, 20, 0, 4)
        badge.BackgroundColor3 = Color3.fromRGB(255, 110, 100)
        badge.Font = Enum.Font.GothamBold
        badge.TextSize = 15
        badge.TextColor3 = Color3.fromRGB(255,255,255)
        badge.BackgroundTransparency = 0.06
        badge.ZIndex = 10
        local badgeCorner = Instance.new("UICorner", badge)
        badgeCorner.CornerRadius = UDim.new(0.5,0)
    end

    -- Tên script (popup preview on click)
    local nameLabel = Instance.new("TextButton", card)
    nameLabel.Text = data.name
    nameLabel.Font = Enum.Font.GothamBold
    nameLabel.TextSize = 20
    nameLabel.TextColor3 = Color3.fromRGB(120,255,120)
    nameLabel.BackgroundTransparency = 1
    nameLabel.Size = UDim2.new(1, -170, 0, 30)
    nameLabel.Position = UDim2.new(0, 96, 0, 13)
    nameLabel.TextXAlignment = Enum.TextXAlignment.Left
    nameLabel.ZIndex = 3

    -- Popup preview code
    nameLabel.MouseButton2Click:Connect(function()
        local popup = Instance.new("Frame")
        popup.Size = UDim2.new(0, 435, 0, 320)
        popup.Position = UDim2.new(0.5, -217, 0.5, -160)
        popup.BackgroundColor3 = Color3.fromRGB(22, 24, 32)
        popup.BorderSizePixel = 0
        popup.Parent = libraryFrame
        popup.ZIndex = 100
        local popCorner = Instance.new("UICorner", popup)
        popCorner.CornerRadius = UDim.new(0.1,0)
        local close = Instance.new("TextButton", popup)
        close.Text = "✖"
        close.Size = UDim2.new(0,34,0,34)
        close.Position = UDim2.new(1,-42,0,8)
        close.BackgroundColor3 = Color3.fromRGB(60,60,70)
        close.TextColor3 = Color3.fromRGB(255,120,120)
        close.Font = Enum.Font.GothamBold
        close.TextSize = 22
        close.ZIndex = 105
        local closeCor = Instance.new("UICorner", close)
        closeCor.CornerRadius = UDim.new(0.5,0)
        close.MouseButton1Click:Connect(function() popup:Destroy() end)
        local scroll = Instance.new("ScrollingFrame", popup)
        scroll.Size = UDim2.new(1,-32,1,-54)
        scroll.Position = UDim2.new(0,16,0,44)
        scroll.BackgroundColor3 = Color3.fromRGB(32,36,48)
        scroll.BorderSizePixel = 0
        scroll.ScrollBarThickness = 10
        scroll.ScrollingDirection = Enum.ScrollingDirection.Y
        scroll.CanvasSize = UDim2.new(0,0,2,0)
        scroll.ZIndex = 101
        local code = Instance.new("TextLabel", scroll)
        code.Size = UDim2.new(1,0,0,1000)
        code.Position = UDim2.new(0,0,0,0)
        code.Text = "Đang tải mã nguồn..."
        code.Font = Enum.Font.Code
        code.TextSize = 15
        code.TextColor3 = Color3.fromRGB(180,255,180)
        code.BackgroundTransparency = 1
        code.TextXAlignment = Enum.TextXAlignment.Left
        code.TextYAlignment = Enum.TextYAlignment.Top
        code.TextWrapped = true
        code.TextTruncate = Enum.TextTruncate.AtEnd
        code.ZIndex = 102
        spawn(function()
            local src = game:HttpGet(data.url)
            code.Text = src:sub(1,6000)
        end)
    end)

    -- Mô tả script
    local descLabel = Instance.new("TextLabel", card)
    descLabel.Text = data.desc
    descLabel.Font = Enum.Font.Gotham
    descLabel.TextSize = 16
    descLabel.TextColor3 = Color3.fromRGB(200,230,255)
    descLabel.BackgroundTransparency = 1
    descLabel.Size = UDim2.new(1, -170, 0, 36)
    descLabel.Position = UDim2.new(0, 96, 0, 44)
    descLabel.TextXAlignment = Enum.TextXAlignment.Left
    descLabel.TextYAlignment = Enum.TextYAlignment.Top
    descLabel.TextWrapped = true
    descLabel.ZIndex = 2

    -- Category
    local catLabel = Instance.new("TextLabel", card)
    catLabel.Text = data.category or "Khác"
    catLabel.Font = Enum.Font.Gotham
    catLabel.TextSize = 14
    catLabel.TextColor3 = Color3.fromRGB(255,225,120)
    catLabel.BackgroundTransparency = 1
    catLabel.Position = UDim2.new(1, -110, 0, 16)
    catLabel.Size = UDim2.new(0, 90, 0, 22)
    catLabel.TextXAlignment = Enum.TextXAlignment.Right
    catLabel.ZIndex = 2
    -- Nút Copy (hiệu ứng)
    local copyBtn = Instance.new("TextButton", card)
    copyBtn.Text = "📋 Copy"
    copyBtn.Size = UDim2.new(0, 72, 0, 34)
    copyBtn.Position = UDim2.new(1, -82, 1, -44)
    copyBtn.BackgroundColor3 = Color3.fromRGB(98, 132, 255)
    copyBtn.TextColor3 = Color3.new(1,1,1)
    copyBtn.Font = Enum.Font.GothamBold
    copyBtn.TextSize = 16
    copyBtn.ZIndex = 3
    local cbCorner = Instance.new("UICorner", copyBtn)
    cbCorner.CornerRadius = UDim.new(0.5, 0)
    copyBtn.MouseButton1Down:Connect(function()
        copyBtn.BackgroundColor3 = Color3.fromRGB(64,100,240)
    end)
    copyBtn.MouseButton1Up:Connect(function()
        copyBtn.BackgroundColor3 = Color3.fromRGB(98, 132, 255)
    end)
    copyBtn.MouseEnter:Connect(function()
        copyBtn.BackgroundColor3 = Color3.fromRGB(128,170,255)
    end)
    copyBtn.MouseLeave:Connect(function()
        copyBtn.BackgroundColor3 = Color3.fromRGB(98, 132, 255)
    end)
    copyBtn.MouseButton1Click:Connect(function()
        setclipboard(data.url)
        copyBtn.Text = "Đã copy!"
        wait(1.1)
        copyBtn.Text = "📋 Copy"
    end)
    -- Nút Chạy (hiệu ứng động)
    local execBtn = Instance.new("TextButton", card)
    execBtn.Text = "▶ Chạy"
    execBtn.Size = UDim2.new(0, 72, 0, 34)
    execBtn.Position = UDim2.new(1, -164, 1, -44)
    execBtn.BackgroundColor3 = Color3.fromRGB(90, 220, 140)
    execBtn.TextColor3 = Color3.new(1,1,1)
    execBtn.Font = Enum.Font.GothamBold
    execBtn.TextSize = 16
    execBtn.ZIndex = 3
    local ebCorner = Instance.new("UICorner", execBtn)
    ebCorner.CornerRadius = UDim.new(0.5, 0)
    execBtn.MouseButton1Down:Connect(function()
        execBtn.BackgroundColor3 = Color3.fromRGB(60,180,100)
    end)
    execBtn.MouseButton1Up:Connect(function()
        execBtn.BackgroundColor3 = Color3.fromRGB(90, 220, 140)
    end)
    execBtn.MouseEnter:Connect(function()
        execBtn.BackgroundColor3 = Color3.fromRGB(120,255,180)
    end)
    execBtn.MouseLeave:Connect(function()
        execBtn.BackgroundColor3 = Color3.fromRGB(90, 220, 140)
    end)
    execBtn.MouseButton1Click:Connect(function()
        execBtn.Text = "Đang chạy..."
        local suc, msg = pcall(function()
            local str = game:HttpGet(data.url)
            local f, err = loadstring(str)
            if not f then error("Script lỗi: "..tostring(err)) end
            f()
        end)
        if suc then
            execBtn.Text = "✓ OK!"
            execBtn.BackgroundColor3 = Color3.fromRGB(40,200,120)
        else
            execBtn.Text = "✗ Lỗi!"
            execBtn.BackgroundColor3 = Color3.fromRGB(200,30,60)
        end
        wait(1.1)
        execBtn.Text = "▶ Chạy"
        execBtn.BackgroundColor3 = Color3.fromRGB(90,220,140)
    end)

    -- Animation hover nổi
    local IsHover = false
    card.MouseEnter:Connect(function()
        IsHover = true
        card.BackgroundColor3 = Color3.fromRGB(54, 62, 90)
        for i=1,6 do
            if not IsHover then break end
            card.Position = card.Position + UDim2.new(0,0,0,-1)
            wait(0.01)
        end
    end)
    card.MouseLeave:Connect(function()
        IsHover = false
        card.BackgroundColor3 = Color3.fromRGB(38, 45, 60)
        card.Position = UDim2.new(0,0,0,0)
    end)
    return card
end

function updateLibraryList()
    -- Loading effect
    for _, v in pairs(libScroll:GetChildren()) do
        if v:IsA("Frame") then v:Destroy() end
    end
    local query = searchBox.Text:lower()
    local selCat = dropCat.Text:match("^[^%a]*(.-) ▼$") or "Tất cả"
    local count = 0
    for _, data in ipairs(scriptLibrary) do
        local matchCat = (selCat == "Tất cả") or (data.category == selCat)
        local matchSearch = (data.name:lower():find(query) or (data.desc and data.desc:lower():find(query)) or (data.category and data.category:lower():find(query)))
        if matchCat and matchSearch then
            createScriptCard(data).Parent = libScroll
            count = count + 1
            wait()  -- Hiệu ứng loading mượt khi render
        end
    end
    scriptCountLabel.Text = "🌟 Số lượng script: " .. count .. " / " .. #scriptLibrary .. " | Right-click tên script để xem mã!"
    libScroll.CanvasSize = UDim2.new(0,0,0,libLayout.AbsoluteContentSize.Y+18)
end
searchBox:GetPropertyChangedSignal("Text"):Connect(updateLibraryList)
updateLibraryList()

-- 4. Settings Tab (GUI scale + color)
local settingsFrame = Instance.new("Frame")
settingsFrame.Size = tabFrameSpace
settingsFrame.Position = tabFramePos
settingsFrame.BackgroundColor3 = Color3.fromRGB(37, 42, 53)
settingsFrame.BorderSizePixel = 0
settingsFrame.Parent = mainFrame
settingsFrame.Visible = false
tabFrames[5] = settingsFrame
local settingsCorner = Instance.new("UICorner", settingsFrame)
settingsCorner.CornerRadius = UDim.new(0, 16)

local settingsTitle = Instance.new("TextLabel")
settingsTitle.Text = "Settings"
settingsTitle.Size = UDim2.new(1, 0, 0, 44)
settingsTitle.Position = UDim2.new(0, 0, 0, 22)
settingsTitle.BackgroundTransparency = 1
settingsTitle.Font = Enum.Font.GothamBold
settingsTitle.TextSize = 28
settingsTitle.TextColor3 = Color3.fromRGB(120, 255, 120)
settingsTitle.Parent = settingsFrame

local scaleLabel = Instance.new("TextLabel")
scaleLabel.Text = "GUI Scale:"
scaleLabel.Size = UDim2.new(0, 170, 0, 32)
scaleLabel.Position = UDim2.new(0, 30, 0, 86)
scaleLabel.BackgroundTransparency = 1
scaleLabel.Font = Enum.Font.Gotham
scaleLabel.TextSize = 22
scaleLabel.TextColor3 = Color3.fromRGB(255, 255, 200)
scaleLabel.TextXAlignment = Enum.TextXAlignment.Left
scaleLabel.Parent = settingsFrame

local scaleValue = Instance.new("TextLabel")
scaleValue.Text = string.format("%.2f", currentScale)
scaleValue.Size = UDim2.new(0, 60, 0, 32)
scaleValue.Position = UDim2.new(0, 200, 0, 86)
scaleValue.BackgroundTransparency = 1
scaleValue.Font = Enum.Font.GothamBold
scaleValue.TextSize = 22
scaleValue.TextColor3 = Color3.fromRGB(120, 255, 120)
scaleValue.TextXAlignment = Enum.TextXAlignment.Center
scaleValue.Parent = settingsFrame

local minusBtn = Instance.new("TextButton")
minusBtn.Text = "-"
minusBtn.Size = UDim2.new(0, 40, 0, 32)
minusBtn.Position = UDim2.new(0, 270, 0, 86)
minusBtn.BackgroundColor3 = Color3.fromRGB(80, 90, 80)
minusBtn.Font = Enum.Font.GothamBold
minusBtn.TextSize = 22
minusBtn.TextColor3 = Color3.fromRGB(255,255,255)
minusBtn.Parent = settingsFrame
local minusCorner = Instance.new("UICorner", minusBtn)
minusCorner.CornerRadius = UDim.new(0.5, 0)

local plusBtn = Instance.new("TextButton")
plusBtn.Text = "+"
plusBtn.Size = UDim2.new(0, 40, 0, 32)
plusBtn.Position = UDim2.new(0, 315, 0, 86)
plusBtn.BackgroundColor3 = Color3.fromRGB(80, 90, 80)
plusBtn.Font = Enum.Font.GothamBold
plusBtn.TextSize = 22
plusBtn.TextColor3 = Color3.fromRGB(255,255,255)
plusBtn.Parent = settingsFrame
local plusCorner = Instance.new("UICorner", plusBtn)
plusCorner.CornerRadius = UDim.new(0.5, 0)

-- Color picker (basic: 5 colors)
local colorLabel = Instance.new("TextLabel")
colorLabel.Text = "GUI Color:"
colorLabel.Size = UDim2.new(0, 170, 0, 32)
colorLabel.Position = UDim2.new(0, 30, 0, 150)
colorLabel.BackgroundTransparency = 1
colorLabel.Font = Enum.Font.Gotham
colorLabel.TextSize = 22
colorLabel.TextColor3 = Color3.fromRGB(255, 255, 200)
colorLabel.TextXAlignment = Enum.TextXAlignment.Left
colorLabel.Parent = settingsFrame

local colorChoices = {
    Color3.fromRGB(35, 38, 48), -- Default
    Color3.fromRGB(32, 44, 60), -- Blue
    Color3.fromRGB(44, 32, 60), -- Purple
    Color3.fromRGB(44, 60, 32), -- Green
    Color3.fromRGB(60, 44, 32), -- Brown
}
local colorPickBtns = {}
for i, col in ipairs(colorChoices) do
    local btn = Instance.new("TextButton")
    btn.Size = UDim2.new(0, 32, 0, 32)
    btn.Position = UDim2.new(0, 200 + (i-1)*38, 0, 150)
    btn.BackgroundColor3 = col
    btn.Text = ""
    btn.Parent = settingsFrame
    local cor = Instance.new("UICorner", btn)
    cor.CornerRadius = UDim.new(0.5, 0)
    colorPickBtns[i] = btn
    btn.MouseButton1Click:Connect(function()
        currentColor = col
        applyGuiColor(mainFrame, col)
    end)
end

-- Scale logic
local function setScale(newScale)
    currentScale = math.clamp(newScale, MIN_SCALE, MAX_SCALE)
    scaleValue.Text = string.format("%.2f", currentScale)
    applyGuiScale(mainFrame, currentScale)
end
plusBtn.MouseButton1Click:Connect(function()
    setScale(currentScale + SCALE_STEP)
end)
minusBtn.MouseButton1Click:Connect(function()
    setScale(currentScale - SCALE_STEP)
end)

-- 5. Credit Tab
local creditFrame = Instance.new("Frame")
creditFrame.Size = tabFrameSpace
creditFrame.Position = tabFramePos
creditFrame.BackgroundColor3 = Color3.fromRGB(40, 44, 50)
creditFrame.BorderSizePixel = 0
creditFrame.Parent = mainFrame
creditFrame.Visible = false
tabFrames[6] = creditFrame
local creditCorner = Instance.new("UICorner", creditFrame)
creditCorner.CornerRadius = UDim.new(0, 16)
local creditLabel = Instance.new("TextLabel")
creditLabel.Text = "Made by GreensVN"
creditLabel.Size = UDim2.new(1, 0, 1, 0)
creditLabel.Position = UDim2.new(0, 0, 0, 0)
creditLabel.BackgroundTransparency = 1
creditLabel.Font = Enum.Font.GothamBold
creditLabel.TextSize = 34
creditLabel.TextColor3 = Color3.fromRGB(120, 255, 120)
creditLabel.TextXAlignment = Enum.TextXAlignment.Center
creditLabel.TextYAlignment = Enum.TextYAlignment.Center
creditLabel.Parent = creditFrame

local TweenService = game:GetService("TweenService")

local function showTab(idx)
    for i, frame in ipairs(tabFrames) do
        if i == idx then
            frame.Visible = true
            frame.Position = UDim2.new(0, TAB_WIDTH + 30, 0, 64) -- Slide in từ phải
            frame.BackgroundTransparency = 1
            -- Hiệu ứng Slide + Fade
            TweenService:Create(frame, TweenInfo.new(0.26, Enum.EasingStyle.Quad), {Position = UDim2.new(0, TAB_WIDTH, 0, 64), BackgroundTransparency = 0}):Play()
        else
            -- Fade out và ẩn sau 0.22s
            TweenService:Create(frame, TweenInfo.new(0.22), {BackgroundTransparency = 1}):Play()
            delay(0.22, function() frame.Visible = false end)
        end
        -- Animate tab button highlight
        TweenService:Create(tabBtns[i], TweenInfo.new(0.18), {
            BackgroundColor3 = (i==idx) and Color3.fromRGB(64, 110, 64) or Color3.fromRGB(55, 55, 65)
        }):Play()
    end
end

for i, btn in ipairs(tabBtns) do
    btn.MouseButton1Click:Connect(function()
        showTab(i)
    end)
    -- Hiệu ứng hover khi rê chuột vào
    btn.MouseEnter:Connect(function()
        if not sidebarCollapsed then
            TweenService:Create(btn, TweenInfo.new(0.13), {BackgroundColor3 = Color3.fromRGB(90, 170, 120)}):Play()
        end
    end)
    btn.MouseLeave:Connect(function()
        if not sidebarCollapsed then
            -- Nếu tab này đang được chọn thì trả lại màu chọn, không thì màu thường
            local isSelected = tabFrames[i].Visible
            TweenService:Create(btn, TweenInfo.new(0.18), {
                BackgroundColor3 = isSelected and Color3.fromRGB(64, 110, 64) or Color3.fromRGB(55, 55, 65)
            }):Play()
        end
    end)
end

-- Drag logic (mouse & touch)
local UIS = game:GetService("UserInputService")
local dragging, dragInput, dragStart, startPos
local function beginDrag(input)
    dragging = true
    dragStart = input.Position
    startPos = mainFrame.Position
    input.Changed:Connect(function()
        if input.UserInputState == Enum.UserInputState.End then dragging = false end
    end)
end
topBar.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
        beginDrag(input)
        dragInput = input
    end
end)
topBar.InputChanged:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch then
        dragInput = input
    end
end)
UIS.InputChanged:Connect(function(input)
    if input == dragInput and dragging then
        local delta = input.Position - dragStart
        mainFrame.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
    end
end)

-- Resize logic
local resizing, resizeInput, resizeStart, startSize
local resizeGrip = Instance.new("Frame")
resizeGrip.Size = UDim2.new(0, 20, 0, 20)
resizeGrip.Position = UDim2.new(1, -20, 1, -20)
resizeGrip.BackgroundColor3 = Color3.fromRGB(100,100,120)
resizeGrip.BorderSizePixel = 0
resizeGrip.Parent = mainFrame
resizeGrip.Active = true
local gripCorner = Instance.new("UICorner", resizeGrip)
gripCorner.CornerRadius = UDim.new(1, 0)
local function beginResize(input)
    resizing = true
    resizeStart = input.Position
    startSize = mainFrame.Size
    input.Changed:Connect(function()
        if input.UserInputState == Enum.UserInputState.End then resizing = false end
    end)
end
resizeGrip.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
        beginResize(input)
        resizeInput = input
    end
end)
resizeGrip.InputChanged:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch then
        resizeInput = input
    end
end)
UIS.InputChanged:Connect(function(input)
    if input == resizeInput and resizing then
        local delta = input.Position - resizeStart
        local newX = math.clamp(startSize.X.Offset + delta.X, MIN_SIZE.X*currentScale, MAX_SIZE.X*currentScale)
        local newY = math.clamp(startSize.Y.Offset + delta.Y, MIN_SIZE.Y*currentScale, MAX_SIZE.Y*currentScale)
        mainFrame.Size = UDim2.new(0, newX, 0, newY)
    end
end)

-- Minimize-to-floating-button logic (mobile & PC)
local minimized = false
local prevSize, prevPosition
local baseBtnSize = 44
local floatBtnSize = baseBtnSize * 1.25
local floatBtn = Instance.new("TextButton")
floatBtn.Size = UDim2.new(0, floatBtnSize, 0, floatBtnSize)
floatBtn.Position = UDim2.new(1, -floatBtnSize - 12, 1, -floatBtnSize - 12)
floatBtn.BackgroundColor3 = Color3.fromRGB(90, 90, 135)
floatBtn.Text = ""
floatBtn.Parent = screenGui
floatBtn.Visible = false
floatBtn.Active = true
floatBtn.ZIndex = 99
local fbCorner = Instance.new("UICorner", floatBtn)
fbCorner.CornerRadius = UDim.new(1, 0)

local floatAvatar = Instance.new("ImageLabel")
floatAvatar.Name = "Avatar"
floatAvatar.Size = UDim2.new(1, -8, 1, -8)
floatAvatar.Position = UDim2.new(0, 4, 0, 4)
floatAvatar.BackgroundTransparency = 1
floatAvatar.Image = AVATAR_ID
floatAvatar.Parent = floatBtn
local floatAvatarCorner = Instance.new("UICorner", floatAvatar)
floatAvatarCorner.CornerRadius = UDim.new(1, 0)

local floatDragging, floatDragInput, floatDragStart, floatStartPos
local function beginFloatDrag(input)
    floatDragging = true
    floatDragStart = input.Position
    floatStartPos = floatBtn.Position
    input.Changed:Connect(function()
        if input.UserInputState == Enum.UserInputState.End then floatDragging = false end
    end)
end
floatBtn.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
        beginFloatDrag(input)
        floatDragInput = input
    end
end)
floatBtn.InputChanged:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch then
        floatDragInput = input
    end
end)
UIS.InputChanged:Connect(function(input)
    if input == floatDragInput and floatDragging then
        local delta = input.Position - floatDragStart
        local scrW = screenGui.AbsoluteSize.X
        local scrH = screenGui.AbsoluteSize.Y
        local newX = math.clamp(floatStartPos.X.Offset + delta.X, 0, scrW - floatBtnSize)
        local newY = math.clamp(floatStartPos.Y.Offset + delta.Y, 0, scrH - floatBtnSize)
        floatBtn.Position = UDim2.new(0, newX, 0, newY)
    end
end)

minBtn.MouseButton1Click:Connect(function()
    if not minimized then
        prevSize = mainFrame.Size
        prevPosition = mainFrame.Position
        mainFrame.Visible = false
        floatBtn.Visible = true
        minimized = true
    end
end)
floatBtn.MouseButton1Click:Connect(function()
    if minimized and not floatDragging then
        mainFrame.Visible = true
        floatBtn.Visible = false
        minimized = false
        if prevSize then
            mainFrame.Size = prevSize
        end
        if prevPosition then
            mainFrame.Position = prevPosition
        end
    end
end)

applyGuiScale(mainFrame, currentScale)
applyGuiColor(mainFrame, currentColor)
